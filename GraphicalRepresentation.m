connectivityMatrixCNN = [NaN,	1.22875988483429,	0.838354051113129,	0.776420831680298,	0.548506259918213,	0.648583590984345,	0.667740941047669,	0.845190405845642,	0.919484734535217,	0.837858438491821,	0.857294976711273,	0.838599681854248,	0.734993875026703,	0.801644206047058,	0.932358980178833,	1.12321019172668,	0.839012742042542,	0.743194222450256,	0.793962121009827;
0.952334165573120,	NaN,	0.856889843940735	0.824879646301270,	0.852302074432373,	0.625804424285889,	0.594547510147095,	0.695071280002594,	0.522199630737305,	0.557484567165375,	0.783991396427155,	0.741297543048859,	0.527578532695770,	0.661926686763763,	0.632859587669373,	0.831762790679932,	0.722150266170502,	0.655463159084320,	0.686789274215698;
0.869259595870972,	1.00209581851959,	NaN,	0.801045417785645,	0.730674564838409,	0.955262303352356,	0.909829139709473,	0.755586087703705,	0.721044182777405,	0.466715753078461,	0.837780237197876,	0.963194191455841,	0.819045424461365,	0.830498278141022,	0.829654812812805,	0.969451963901520,	0.891511142253876,	0.744589507579804,	0.843445718288422;
0.355534434318543,	0.193699330091476,	0.211867481470108,	NaN,	0.305997252464294,	0.532690584659576,	0.220697432756424,	0.463228225708008,	0.310045391321182,	0.112294867634773,	0.215272009372711,	0.142238616943359,	0.218630895018578,	0.364072531461716,	0.342960208654404,	0.441497504711151,	0.333627164363861,	0.403942584991455,	0.360926598310471;
0.318391650915146,	0.262624889612198,	0.378711491823196,	0.684073805809021,	NaN	0.263485550880432,	0.259713172912598,	0.336233943700790,	0.434232920408249,	0.424657225608826,	0.414115250110626,	0.281515419483185,	0.317565113306046,	0.466706752777100,	0.437598496675491,	0.341473042964935,	0.245221912860870,	0.533221244812012,	0.541397809982300;
0.633236050605774,	0.513716459274292,	0.582780718803406,	0.979580640792847,	0.621147394180298,	NaN,	0.425846219062805,	0.772891759872437,	0.413074374198914,	0.524403631687164,	0.667690932750702,	0.407866656780243,	0.615460753440857,	0.452106475830078,	0.566572666168213,	0.742928147315979,	0.571127295494080,	0.488517552614212,	0.601834893226624;
0.772014677524567,	0.548969805240631,	0.574199676513672,	0.834914147853851,	0.827131092548370,	0.682484388351440,	NaN,	1.35871732234955,	1.58466815948486,	0.627224445343018,	0.641788840293884,	0.562123775482178,	0.772820472717285,	0.694146037101746,	0.737435281276703,	0.918101251125336,	0.836256146430969,	0.956186056137085,	0.809248447418213;
0.944885373115540,	0.933673322200775,	0.904843151569367,	1.03742074966431,	0.969636976718903,	0.930245399475098,	1.10181367397308,	NaN,	1.46929109096527,	0.623379588127136,	0.940274775028229,	0.667173147201538,	0.960800468921661,	1.07018733024597,	0.948343515396118,	1.14230501651764,	0.811609327793121,	0.935747623443604,	0.946955323219299;
0.950042128562927,	0.698944628238678,	0.813906431198120,	0.822202026844025,	0.858155727386475,	0.914468288421631,	1.73370575904846,	1.15357601642609,	NaN,	0.841343104839325,	0.944181263446808,	0.804781138896942,	0.831132233142853,	0.789101362228394,	0.774295449256897,	0.838611841201782,	1.06361103057861,	1.06703782081604,	1.35170948505402;
0.496081084012985,	0.510106742382050,	0.597410678863525,	0.631299972534180,	0.762500107288361,	0.698639750480652,	0.486511886119843,	0.338497757911682,	0.469591319561005,	NaN,	0.268327772617340,	0.639486312866211,	0.493776500225067,	0.565674901008606,	0.549159586429596,	0.594868957996368,	0.371967107057571,	0.537235498428345,	0.555648088455200;
0.785664558410645,	0.792177557945252,	0.607699632644653,	0.838203907012940,	0.654362797737122,	0.846411466598511,	0.640666842460632,	0.575066804885864,	0.787549674510956,	0.719763278961182,	NaN,	0.673046231269836,	0.782251417636871,	0.734163463115692,	0.684728801250458,	0.562068343162537,	0.646131634712219,	0.738718569278717,	0.702161669731140;
0.977230608463287,	0.998503804206848,  1.07671284675598,	1.02897286415100,	1.07534635066986,	0.930801153182983,	0.836255133152008,	1.03666996955872,	1.07526135444641,	0.802010774612427,	0.908463954925537,	NaN,	0.863151907920837,	0.783274531364441,	0.853545844554901,	0.928010225296021,	1.14923548698425,	0.673496067523956,	0.881166994571686;
0.953694581985474,	0.900770187377930,  1.02337181568146,	0.892027676105499,	0.929711639881134,	0.786402940750122,	0.737451136112213,	0.756042659282684,	1.02113986015320,	0.944547832012177,	0.872134327888489,	0.655748307704926,	NaN	1.09215915203094,	0.949114441871643,	1.01008009910584,	0.844189167022705,	0.779476821422577,	0.785367906093597;
0.910023808479309,	0.715974092483521,	0.744499623775482,	0.951334595680237,	1.05166113376617,	0.816749751567841,	0.793483257293701,	0.669034540653229,	0.878326714038849,	0.932534277439117,	0.807204484939575,	0.548272490501404,	0.846462070941925,	NaN,	1.11047697067261,	0.912594556808472,	0.727041661739349,	0.870644867420197,	0.774657785892487;
0.773547053337097,	0.839269638061523,	0.625359773635864,	0.897321581840515,	0.856895089149475,	0.645704746246338,	0.914964079856873,	0.732179522514343,	0.834508299827576,	0.794117987155914,	0.850890755653381,	0.746695041656494,	0.863605380058289,	0.997840642929077,	NaN	1.09022521972656,	0.963334858417511,	0.703434884548187,	0.713060200214386;
0.941008329391480,	0.905095398426056,	0.856476128101349,	1.11254692077637,	0.956894040107727,	0.724258303642273,	0.847867190837860,	0.786726176738739,	0.982402563095093,	0.774784862995148,	0.810252964496613,	0.925328969955444,	0.909508705139160,	0.998876571655273,	0.985371112823486,	NaN,	1.23298406600952,	0.813664138317108,	0.735893070697784;
0.797486364841461,	0.556750893592835,	0.781305313110352,	0.909993171691895,	0.725520551204681,	0.902969479560852,	0.634692072868347,	0.774057090282440,	0.802763462066650,	0.771231055259705,	0.701305508613586,	0.514947772026062,	0.863801002502441,	0.640840888023377,	0.974418699741364,	1.15914833545685,	NaN,	0.588643670082092,	0.720762133598328;
1.02586865425110,	1.08509099483490,	1.11698019504547,	1.05540084838867,	1.45807325839996,	1.00399649143219,	1.15201234817505,	1.27021086215973,	1.11796092987061,	1.06237411499023,	1.13218903541565,	1.10725069046021,	1.04006481170654,	1.28374946117401,	1.21159410476685,	1.02407205104828,	1.38694381713867,	NaN,	1.34605479240417;
1.07522320747375,	1.07353270053864,	1.13724255561829,	1.25666677951813,	1.18940949440002,	1.22168874740601,	0.980204463005066,	0.992627739906311,	1.14280462265015,	1.05954837799072,	1.01931011676788,	0.920255184173584,	1.14670598506928,	0.974401950836182,	1.02780008316040,	1.00940966606140,	1.25017499923706,	0.776030302047730,	NaN ];


% Finding the minimum and maximum values
minValue = min(connectivityMatrixCNN(:)); 
maxValue = max(connectivityMatrixCNN(:)); 

disp(minValue);
% Define partitions and colors
edges = linspace(minValue, maxValue, 6);  % 5 partitions
colors = [
    [1, 0, 0];    % Red
    [0, 1, 0];    % Green
    [0, 0, 1];    % Blue
    [1, 1, 0];    % Yellow
    [1, 0, 1];    % Magenta
];

% Define node names
nodeNames = {'C3', 'Cz', 'C4', 'Fp1', 'Fp2', 'F7', 'F3', 'Fz', 'F4', 'F8', ...
             'T7', 'T8', 'P7', 'P3', 'Pz', 'P4', 'P8', 'O1', 'O2'};

% Build the directed graph
G = digraph();
[numNodes, ~] = size(connectivityMatrixCNN);
for i = 1:numNodes
    for j = 1:numNodes
        if ~isnan(connectivityMatrixCNN(i, j))
            % Add edge with weight
            G = addedge(G, i, j, connectivityMatrixCNN(i, j));
        end
    end
end

% Assign edge colors based on weights
edgeColors = zeros(numedges(G), 3);
weights = G.Edges.Weight;

for k = 1:numedges(G)
    weight = weights(k);
    for bin = 1:5
        if edges(bin) <= weight && weight < edges(bin + 1)
            edgeColors(k, :) = colors(bin, :);
            break;
        end
    end
end

% Plot the graph with custom node names
figure;
h = plot(G, 'Layout', 'force');

% Set node labels to the defined names
h.NodeLabel = nodeNames;

% Apply colors to edges
for k = 1:numedges(G)
    highlight(h, 'Edges', k, 'EdgeColor', edgeColors(k, :), 'LineWidth', 1.0);
end

% Add a legend for partitions
hold on;
for bin = 1:5
    plot(NaN, NaN, 'Color', colors(bin, :), 'LineWidth', 1.5, 'DisplayName', ...
        sprintf('%.4f to %.4f', edges(bin), edges(bin + 1)));
end
legend('show', 'Location', 'bestoutside');
title('Directed Graph - CNN model');
